{% extends "base.html" %}

{% block title %}Block Details{% endblock %}

{% block content %}
<script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
<div class="d-flex justify-content-between align-items-center mb-4">

    <h2 class="display-6">{{block.name}} Details</h2>
    <div class="d-flex gap-2 align-items-center"> 
        <div class="dropdown my-dropdown">
            <button class="btn btn-outline-light btn-sm dropdown-toggle" type="button">
                Chart Data
            </button>
            <ul class="dropdown-menu dropdown-menu-end shadow">
                <li>
                    <button class="dropdown-item" 
                            hx-get="/get_chart/{{block.block_id}}?type=time" 
                            hx-target="#chart-display" 
                            hx-swap="innerHTML">
                        Time
                    </button>
                </li>
                <li>
                    <button class="dropdown-item" 
                            hx-get="/get_chart/{{block.block_id}}?type=distance_km" 
                            hx-target="#chart-display"
                            hx-swap="innerHTML">
                        Distance (km)
                    </button>
                </li>
                <li>
                    <button class="dropdown-item" 
                            hx-get="/get_chart/{{block.block_id}}?type=training_load" 
                            hx-target="#chart-display"
                            hx-swap="innerHTML">
                        Training Load
                    </button>
                </li>
            </ul>
        </div>

        <div class="d-flex gap-2 align-items-center"> 
            <a href="/delete_block/{{block.block_id}}" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure you want to delete this block?');">Delete Block</a>
        </div>
    </div>
</div>

<div class="container mt-4">
    <div id="chart-display" class="chart-container shadow-sm p-3 mb-5 bg-white rounded">
        {{ chart | safe }}
    </div>
</div>
<style>
    h2 {
        color: #f8f9fa;
    }
    .my-dropdown:hover .dropdown-menu {
        display: block;
        margin-top: 0;
    }
    .dropdown-toggle::after {
        vertical-align: middle;
    }
    .dropdown-item {
        font-size: 0.9rem;
        transition: background-color 0.2s;
    }

    .dropdown-item:hover {
        background-color: #f5f6f7;
    }
    a {
        text-decoration: none;
        color: black;
    }
</style>
{% endblock %}